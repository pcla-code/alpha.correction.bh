---
title: "alpha-correction"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{alpha-correction}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>"
)
```

```{r setup}
library(edu.upenn.pcla.alpha.correction)
```

## Introduction

This package provides functions for calculating alpha corrections for a list of p-values according to the Benjamini-Hochberg alpha correction.

For an ordered list l containing m sorted p-values, the alpha for each p-value is computed as:

                              alpha = (i/m)Q

where:

-   i is the order of the p-value in list l (1 to m) and
-   Q is the false discovery rate, which is 0.05 by default.


### Usage
`get_alphas(p_values, Q)`

Use this function to calculate corrected values for a list of p-values and a given false discovery rate Q.

If you do not provide Q, a default value of 0.05 will be used.

The function will sort the list of p-values, but you are encouraged to pass a sorted list nonetheless, so you can readily compare the p-values your passed to the returned alphas.

#### Example 1:

`get_alphas(list(0.01,0.08,0.039))`

Output:

[[1]]
[1] 0.01666667

[[2]]
[1] 0.03333333

[[3]]
[1] 0.05

#### Example 2:

`get_alphas(list(0.01,0.08,0.039), .07)`


Output:

[[1]]
[1] 0.02333333

[[2]]
[1] 0.04666667

[[3]]
[1] 0.07